
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Hotdog hra ‚Äì mobiln√≠ verze</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #111;
      height: 100%;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
    }

    canvas {
      display: block;
      width: 100%;
      flex: 1;
      background: #fff;
    }

    #touchControls {
      background: #111;
      padding: 10px;
      text-align: center;
    }

    #touchControls button {
      font-size: 24px;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="touchControls">
  <button id="leftBtn">‚¨ÖÔ∏è</button>
  <button id="jumpBtn">‚è´</button>
  <button id="rightBtn">‚û°Ô∏è</button>
  <button id="shootBtn">üî´</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const GAME_WIDTH = 480;
const GAME_HEIGHT = 320;

canvas.width = GAME_WIDTH;
canvas.height = GAME_HEIGHT;

const playerImage = new Image();
playerImage.src = "hotdog-sad.png";
const bulletImage = new Image();
bulletImage.src = "parek.png";
const enemyImage = new Image();
enemyImage.src = "enemy.png";

const shootSound = new Audio("mortar.mp3");
const explosionSound = new Audio("explosion.mp3");

const player = {
  x: 40,
  y: 40,
  width: 60,
  height: 85,
  velX: 0,
  velY: 0,
  speed: 1.5,
  jumpForce: -6,
  gravity: 0.2,
  grounded: false
};

let floorY = GAME_HEIGHT - 10;

const platforms = [
  { x: 50, y: 220, width: 100, height: 15 },
  { x: 180, y: 150, width: 100, height: 15 },
  { x: 300, y: 90, width: 100, height: 15 }
];

let enemy = {
  x: 350,
  y: 200,
  width: 45,
  height: 45,
  alive: true
};

const bullets = [];
const bulletSpeed = 2;
const bulletSize = 25;
let lastDir = 1;
let ammo = 5;

const keys = {};

document.addEventListener("keydown", (e) => {
  keys[e.key] = true;
  if (e.key === "a") lastDir = -1;
  if (e.key === "d") lastDir = 1;
  if (e.key === "e") shootBullet();
});
document.addEventListener("keyup", (e) => {
  keys[e.key] = false;
});

function updatePlayer() {
  if (keys["a"]) player.velX = -player.speed;
  else if (keys["d"]) player.velX = player.speed;
  else player.velX = 0;

  if (keys["w"] && player.grounded) {
    player.velY = player.jumpForce;
    player.grounded = false;
  }

  player.velY += player.gravity;
  player.x += player.velX;
  player.y += player.velY;

  player.grounded = false;

  if (player.y + player.height >= floorY) {
    player.y = floorY - player.height;
    player.velY = 0;
    player.grounded = true;
  }

  platforms.forEach(p => {
    const withinX = player.x + player.width > p.x && player.x < p.x + p.width;
    const hittingTop = player.y + player.height <= p.y && player.y + player.height + player.velY >= p.y;
    if (withinX && hittingTop) {
      player.y = p.y - player.height;
      player.velY = 0;
      player.grounded = true;
    }
  });
}

function shootBullet() {
  if (ammo > 0) {
    bullets.push({
      x: player.x + (lastDir === 1 ? player.width : -bulletSize),
      y: player.y + player.height / 2 - bulletSize / 2,
      velX: bulletSpeed * lastDir
    });
    ammo--;
    shootSound.currentTime = 0;
    shootSound.play();
  }
}

function updateBullets() {
  for (let i = bullets.length - 1; i >= 0; i--) {
    bullets[i].x += bullets[i].velX;
    const b = bullets[i];
    if (enemy.alive &&
        b.x < enemy.x + enemy.width &&
        b.x + bulletSize > enemy.x &&
        b.y < enemy.y + enemy.height &&
        b.y + bulletSize > enemy.y) {
      enemy.alive = false;
      playerImage.src = "hotdog-happy.png";
      explosionSound.play();
      bullets.splice(i, 1);
      continue;
    }
    if (b.x < 0 || b.x > GAME_WIDTH) bullets.splice(i, 1);
  }
}

function drawGame() {
  ctx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
  ctx.fillStyle = "#ddd";
  ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

  ctx.fillStyle = "#555";
  ctx.fillRect(0, floorY, GAME_WIDTH, 10);

  ctx.fillStyle = "#888";
  platforms.forEach(p => ctx.fillRect(p.x, p.y, p.width, p.height));

  ctx.drawImage(playerImage, player.x, player.y, player.width, player.height);

  if (enemy.alive)
    ctx.drawImage(enemyImage, enemy.x, enemy.y, enemy.width, enemy.height);

  bullets.forEach(b => {
    ctx.drawImage(bulletImage, b.x, b.y, bulletSize, bulletSize);
  });

  ctx.fillStyle = "#000";
  ctx.font = "14px sans-serif";
  ctx.fillText("N√°boje: " + ammo, 10, 20);
}

function gameLoop() {
  updatePlayer();
  updateBullets();
  drawGame();
  requestAnimationFrame(gameLoop);
}

Promise.all([
  new Promise(res => { playerImage.onload = res; }),
  new Promise(res => { bulletImage.onload = res; }),
  new Promise(res => { enemyImage.onload = res; })
]).then(() => {
  gameLoop();
});

function simulateKey(key, isPressed) {
  keys[key] = isPressed;
  if (key === "a" && isPressed) lastDir = -1;
  if (key === "d" && isPressed) lastDir = 1;
  if (key === "e" && isPressed) shootBullet();
}

["leftBtn", "rightBtn", "jumpBtn", "shootBtn"].forEach(id => {
  const btn = document.getElementById(id);
  const keyMap = { leftBtn: "a", rightBtn: "d", jumpBtn: "w", shootBtn: "e" };
  btn.addEventListener("touchstart", e => {
    e.preventDefault();
    simulateKey(keyMap[id], true);
  });
  btn.addEventListener("touchend", e => {
    e.preventDefault();
    simulateKey(keyMap[id], false);
  });
});
</script>

</body>
</html>
